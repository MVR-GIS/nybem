---
title: "ecorest_examples"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ecorest_examples}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup}
library(ecorest)
```

```{r}
ecorest_db <- ecorest::HSImetadata
hsi_models <- HSImodels
```

## SIcalc example
```{r}
#Build and define a matrix of the Barred Owl suitability curves
#Allen A.W. 1982. Habitat Suitability Index Models: Barred owl. FWS/OBS 82/10.143.
#U.S. Fish and Wildlife Service. https://pubs.er.usgs.gov/publication/fwsobs82_10_143.
var1 <- cbind(c(0,2,4,NA), c(0.1,1,1,NA)) #Number of trees > 51cm diameter per 0.4 ha plot
var2 <- cbind(c(0,5,20,NA), c(0,0,1,NA)) #Mean diameter of overstory trees
var3 <- cbind(c(0,20,60,100), c(0,0,1,1)) #Percent canopy cover of overstory trees
barredowl_matrix <- cbind(var1, var2, var3)
barredowl_1 <- as.data.frame(barredowl_matrix)
colnames(barredowl_1)<- c("tree.num", "tree.num.SIV", "avg.dbh.in", 
                          "avg.dbh.SIV", "can.cov", "can.cov.SIV")

#Set user input variables that should return (1, 0, 0)
input.demo1 <- c(2, 5, 20)
SIcalc(barredowl_1, input.demo1)
```

```{r}
#Suitability curves may also be drawn from HSImodels (data within ecorest)
#Import Barred Owl suitability curves with HSImodels$barredowl
#The input examples are repeated from above

#Set user input variables that should return (1, 0, 0)
barredowl_2 <- HSImodels$barredowl
SIcalc(barredowl_2, input.demo1)
```

## HSIarimean example
```{r}
#Determine patch quality based on a vector of four suitability indices.
HSIarimean(c(0.25, 0.25, 0.25, 0.25))

#Determine patch quality based on a vector of suitability indices with an NA.
HSIarimean(c(0.25, 0.25, NA, 0.25))

#Demonstrate error message associated with out of range outcomes.
HSIarimean(c(0.25, 0.25, 10.00, 0.25))
```

## HSIplotter example
```{r}
#Build and define a matrix of the Barred Owl suitability curves
#Allen A.W. 1982. Habitat Suitability Index Models: Barred owl. FWS/OBS 82/10.143.
#U.S. Fish and Wildlife Service. https://pubs.er.usgs.gov/publication/fwsobs82_10_143.
var1 <- cbind(c(0,2,4,NA), c(0.1,1,1,NA)) #Number of trees > 51cm diameter per 0.4 ha plot
var2 <- cbind(c(0,5,20,NA), c(0,0,1,NA)) #Mean diameter of overstory trees
var3 <- cbind(c(0,20,60,100), c(0,0,1,1)) #Percent canopy cover of overstory trees
barredowl_3<- cbind(var1, var2, var3)
colnames(barredowl_3)<- c("tree.num", "tree.num.SIV",
  "avg.dbh.in", "avg.dbh.SIV", "can.cov", "can.cov.SIV")

#Create suitability curve summary plot
HSIplotter(barredowl_3, figure.name = "BarredOwl.jpeg")
knitr::include_graphics(path = "BarredOwl.jpeg")
```


## Example 1
```{r example-1}
#Grab a model - store as character string
ExampleModel1 <- "barredowl"

#Location of example model in data sets
ExampleLoc1 <- which(HSImetadata$model == ExampleModel1)

#Example inputs for the barred owl model
ExampleInput1 <- c(1.5, 15, 50)
ExampleArea1 <- 100

#Create empty data frame for results
ExampleOutput1 <- data.frame(rep(NA, length(ExampleInput1)+6))
colnames(ExampleOutput1) <- "Example1"
row.names(ExampleOutput1) <- c(colnames(HSImodels[[ExampleLoc1]])[seq(2,length.out=length(ExampleInput1),by=2)], 
                               "eqtn", "min", "arimean", "geomean", "Area", "HUs.Eqtn")

#Compute suitability for each variable
ExampleOutput1[1:length(ExampleInput1),] <- SIcalc(HSImodels[[ExampleLoc1]], ExampleInput1)

#Compute overall habitat suitability with four different methods
ExampleOutput1[length(ExampleInput1)+1,] <- HSIeqtn(ExampleModel1, ExampleOutput1[1:length(ExampleInput1),], HSImetadata)
ExampleOutput1[length(ExampleInput1)+2,] <- HSImin(ExampleOutput1[1:length(ExampleInput1),])
ExampleOutput1[length(ExampleInput1)+3,] <- HSIarimean(ExampleOutput1[1:length(ExampleInput1),])
ExampleOutput1[length(ExampleInput1)+4,] <- HSIgeomean(ExampleOutput1[1:length(ExampleInput1),])
ExampleOutput1[length(ExampleInput1)+5,] <- ExampleArea1
ExampleOutput1[length(ExampleInput1)+6,] <- ExampleOutput1[length(ExampleInput1)+1,] * ExampleOutput1[length(ExampleInput1)+5,] 
ExampleOutput1

#Added lines troubleshooting HUcalc
HUcalc(ExampleOutput1[1:3,], ExampleOutput1[8,], HSIarimean)
HUcalc(ExampleOutput1[1:3,], ExampleOutput1[8,], HSIgeomean)
HUcalc(ExampleOutput1[1:3,], ExampleOutput1[8,], HSImin)

```

```{r}
model_name <- "barredowl"

# Identify model record number
model_index_num <- which(ecorest::HSImetadata$model == model_name)

# Barredowl observed metric values
bo_obs <- list(1.5, 15, 50)
bo_obs_area <- 100

bo_model <- HSImodels[[model_index_num]]

results <- data.frame(rep(NA, length(bo_obs) + 6))
colnames(results) <- "Example1"
row.names(results) <- c(colnames(bo_model)[seq(2, length.out = length(bo_obs), by = 2)], 
                        "eqtn", "min", "arimean", "geomean", "Area", "HUs.Eqtn")

```


## Example 2
```{r example-2}
#Grab a model - store as character string
ExampleModel2 <- "barredowl"

#Location of example model in data sets
ExampleLoc2 <- which(HSImetadata$model == ExampleModel2)

#Example inputs for the barred owl model
ExampleInput2 <- c(2, 20, 40)
ExampleArea2 <- 100

#Create empty data frame for results
ExampleOutput2 <- data.frame(rep(NA, length(ExampleInput2)+6))
colnames(ExampleOutput2) <- "Example2"
row.names(ExampleOutput2) <- c(colnames(HSImodels[[ExampleLoc1]])[seq(2,length.out=length(ExampleInput2),by=2)], 
                               "eqtn", "min", "arimean", "geomean", "Area", "HUs.Eqtn")

#Compute suitability for each variable
ExampleOutput2[1:length(ExampleInput2),] <- SIcalc(HSImodels[[ExampleLoc1]], ExampleInput2)

#Compute overall habitat suitability with four different methods
ExampleOutput2[length(ExampleInput2)+1,] <- HSIeqtn(ExampleModel2, ExampleOutput2[1:length(ExampleInput2),], HSImetadata)
ExampleOutput2[length(ExampleInput2)+2,] <- HSImin(ExampleOutput2[1:length(ExampleInput2),])
ExampleOutput2[length(ExampleInput2)+3,] <- HSIarimean(ExampleOutput2[1:length(ExampleInput2),])
ExampleOutput2[length(ExampleInput2)+4,] <- HSIgeomean(ExampleOutput2[1:length(ExampleInput2),])
ExampleOutput2[length(ExampleInput2)+5,] <- ExampleArea2
ExampleOutput2[length(ExampleInput2)+6,] <- ExampleOutput2[length(ExampleInput2)+1,] * ExampleOutput2[length(ExampleInput2)+5,] 
ExampleOutput2

#Added lines troubleshooting HUcalc
HUcalc(ExampleOutput2[1:3,], ExampleOutput2[8,], HSIarimean)
HUcalc(ExampleOutput2[1:3,], ExampleOutput2[8,], HSIgeomean)
HUcalc(ExampleOutput2[1:3,], ExampleOutput2[8,], HSImin)
```


## Example 3
```{r example-3}
#Grab a model - store as character string
ExampleModel3 <- "blackbrant"

#Location of example model in data sets
ExampleLoc3 <- which(HSImetadata$model == ExampleModel3)

#Example inputs for the barred owl model
ExampleInput3 <- c(45, 5)
ExampleArea3 <- 100

#Create empty data frame for results
ExampleOutput3 <- data.frame(rep(NA, length(ExampleInput3)+6))
colnames(ExampleOutput3) <- "Example3"
row.names(ExampleOutput3) <- c(colnames(HSImodels[[ExampleLoc3]])[seq(2,length.out=length(ExampleInput3),by=2)], 
                               "eqtn", "min", "arimean", "geomean", "Area", "HUs.Eqtn")

#Compute suitability for each variable
ExampleOutput3[1:length(ExampleInput3),] <- SIcalc(HSImodels[[ExampleLoc3]], ExampleInput3)

#Compute overall habitat suitability with four different methods
ExampleOutput3[length(ExampleInput3)+1,] <- HSIeqtn(ExampleModel3, ExampleOutput3[1:length(ExampleInput3),], HSImetadata)
ExampleOutput3[length(ExampleInput3)+2,] <- HSImin(ExampleOutput3[1:length(ExampleInput3),])
ExampleOutput3[length(ExampleInput3)+3,] <- HSIarimean(ExampleOutput3[1:length(ExampleInput3),])
ExampleOutput3[length(ExampleInput3)+4,] <- HSIgeomean(ExampleOutput3[1:length(ExampleInput3),])
ExampleOutput3[length(ExampleInput3)+5,] <- ExampleArea2
ExampleOutput3[length(ExampleInput3)+6,] <- ExampleOutput3[length(ExampleInput3)+1,] * ExampleOutput3[length(ExampleInput3)+5,] 
ExampleOutput3

#Added lines troubleshooting HUcalc
HUcalc(ExampleOutput3[1:2,], ExampleOutput3[7,], HSIarimean)
HUcalc(ExampleOutput3[1:2,], ExampleOutput3[7,], HSIgeomean)
HUcalc(ExampleOutput3[1:2,], ExampleOutput3[7,], HSImin)
```

## Example 4
```{r example-4}
#Grab a model - store as character string
ExampleModel4 <- "sliderturtle"

#Location of example model in data sets
ExampleLoc4 <- which(HSImetadata$model == ExampleModel4)

#Example inputs for the barred owl model
ExampleInput4 <- c(45, 40, 0.5, "c")
ExampleArea4 <- 100

#Create empty data frame for results
ExampleOutput4 <- data.frame(rep(NA, length(ExampleInput4)+6))
colnames(ExampleOutput4) <- "Example4"
row.names(ExampleOutput4) <- c(colnames(HSImodels[[ExampleLoc4]])[seq(2,length.out=length(ExampleInput4),by=2)], 
                               "eqtn", "min", "arimean", "geomean", "Area", "HUs.Eqtn")

#Compute suitability for each variable
ExampleOutput4[1:length(ExampleInput4),] <- SIcalc(HSImodels[[ExampleLoc4]], ExampleInput4)

#Compute overall habitat suitability with four different methods
ExampleOutput4[length(ExampleInput4)+1,] <- HSIeqtn(ExampleModel4, ExampleOutput4[1:length(ExampleInput4),], HSImetadata)
ExampleOutput4[length(ExampleInput4)+2,] <- HSImin(ExampleOutput4[1:length(ExampleInput4),])
ExampleOutput4[length(ExampleInput4)+3,] <- HSIarimean(ExampleOutput4[1:length(ExampleInput4),])
ExampleOutput4[length(ExampleInput4)+4,] <- HSIgeomean(ExampleOutput4[1:length(ExampleInput4),])
ExampleOutput4[length(ExampleInput4)+5,] <- ExampleArea2
ExampleOutput4[length(ExampleInput4)+6,] <- ExampleOutput4[length(ExampleInput4)+1,] * ExampleOutput4[length(ExampleInput4)+5,] 
ExampleOutput4
```

